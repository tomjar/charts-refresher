<!doctype html>
<html>

<head>
    <meta charset="UTF-8">
    <title>Error crunch time, lets get to crunching!</title>
    <script type="text/javascript" src="Chart.js"></script>
    <script type="text/javascript" src="ErrorCruncher.js"></script>
    <script type="text/javascript">
        function showChart(canvasid, chartType, labels, data, colors, chartName) {

            // Chart.defaults.polarArea.borderAlign = 'inner';
            // Chart.defaults.global.legend.rtl = false;
            Chart.defaults.global.legend.position = 'left';
            var ctx = document.getElementById(canvasid).getContext('2d');
            var myChart = new Chart(ctx, {
                type: chartType, // bar, line, pie
                data: {
                    labels: labels,
                    datasets: [{
                        label: chartName,
                        data: data,
                        backgroundColor: colors,
                        borderColor: colors,
                        borderWidth: 1
                    }],
                    options: {
                        scales: {
                            yAxes: [{
                                ticks: {
                                    beginAtZero: true
                                }
                            }]
                        }
                    }
                }
            });
        }


        window.addEventListener("load", function (event) {

            ErrorCruncher.getDataFileAsync(function (response) {
                var errors = JSON.parse(response).errors,
                    errorsByType = ErrorCruncher.errorsByType(errors),
                    errorsByUser = ErrorCruncher.errorsByUser(errors),
                    errorsByHost = ErrorCruncher.errorsByHost(errors),
                    errorsBySource = ErrorCruncher.errorsBySource(errors),
                    errorsByMonth = ErrorCruncher.errorsByMonth(errors),
                    errorsByDay = ErrorCruncher.errorsByDay(errors);

                // console.log(errorsByType);
                showChart(
                    'errorsByType',
                    'polarArea',
                    errorsByType.labels,
                    errorsByType.data,
                    errorsByType.colors,
                    'Errors by Type');

                // console.log(errorsByUser);
                showChart(
                    'errorsByUser',
                    'polarArea',
                    errorsByUser.labels,
                    errorsByUser.data,
                    errorsByUser.colors,
                    'Errors by User');

                // console.log(errorsByHost);
                showChart(
                    'errorsByHost',
                    'polarArea',
                    errorsByHost.labels,
                    errorsByHost.data,
                    errorsByHost.colors,
                    'Errors by Host');

                // console.log(errorsBySource);
                showChart(
                    'errorsBySource',
                    'polarArea',
                    errorsBySource.labels,
                    errorsBySource.data,
                    errorsBySource.colors,
                    'Errors by Source');

                // console.log(errorsByMonth);
                showChart(
                    'errorsByMonth',
                    'line',
                    errorsByMonth.labels,
                    errorsByMonth.data,
                    errorsByMonth.colors,
                    'Errors by Month');

                // console.log(errorsByDay);
                showChart(
                    'errorsByDay',
                    'line',
                    errorsByDay.labels,
                    errorsByDay.data,
                    errorsByDay.colors,
                    'Errors by Day'
                )


            });
        });
    </script>
    <style>
        .grid-container {
            display: grid;
            grid-template-columns: auto;
            text-align: center;
            background-color: aqua;
        }

        .grid-item {
            background-color: rgba(255, 255, 255, 0.8);
            border: 1px solid rgba(0, 0, 0, 0.8);
        }
        .pie-chart{
        }
    </style>
</head>

<body>

    <div class="grid-container">
        <div class="grid-item pie-chart">
            <canvas id="errorsByType"></canvas>
        </div>
        <div class="grid-item pie-chart">
            <canvas id="errorsByUser"></canvas>
        </div>
        <div class="grid-item pie-chart">
            <canvas id="errorsByHost"></canvas>
        </div>
        <div class="grid-item pie-chart">
            <canvas id="errorsBySource"></canvas>
        </div>
        <div class="grid-item bottom-grid-item line-bar-chart">
            <canvas id="errorsByMonth"></canvas>
        </div>
        <div class="grid-item bottom-grid-item line-bar-chart">
            <canvas id="errorsByDay"></canvas>
        </div>
    </div>
</body>

</html>